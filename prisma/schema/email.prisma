model Email {
  id               String           @id @default(cuid())
  senderEmail      String
  receiverEmail    String?
  subject          String?
  body             String
  attachment       String[]
  isReadBySender   Boolean          @default(true)
  isReadByReceiver Boolean          @default(false)
  isDraft          Boolean          @default(false)
  isSent           Boolean          @default(false)
  createdAt        DateTime         @default(now())
  senderId         String
  receiverId       String?
  parentEmailId    String?
  threadId         String?
  isReply          Boolean          @default(false)
  isArchived       Boolean          @default(false)
  isSpam           Boolean          @default(false)
  isStarred        Boolean          @default(false)
  isDeleted        Boolean          @default(false)
  parentEmail      Email?           @relation("EmailReplies", fields: [parentEmailId], references: [id])
  replies          Email[]          @relation("EmailReplies")
  receiver         users?           @relation("ReceivedEmails", fields: [receiverId], references: [id])
  sender           users            @relation("SentEmails", fields: [senderId], references: [id])
  states           UserEmailState[]
}

model UserEmailState {
  id         String  @id @default(cuid())
  emailId    String
  userId     String
  isRead     Boolean @default(false)
  isStarred  Boolean @default(false)
  isArchived Boolean @default(false)
  isSpam     Boolean @default(false)
  isDeleted  Boolean @default(false)
  isDraft    Boolean @default(false)
  email      Email   @relation(fields: [emailId], references: [id])
  user       users   @relation(fields: [userId], references: [id])

  @@unique([emailId, userId])
}
